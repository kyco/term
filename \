mod app;
mod args;
mod config;
mod repository;

use anyhow::Result;
use app::App;
use clap::Parser;
use config::{repository::ConfigRepository, service::config_service};
use repository::db::SqliteRepository;

fn main() -> Result<()> {
    let args = args::Args::parse();
    let repo = SqliteRepository::new("app.db")?;
    let app = App::new(repo)?;

    if let Some(set_chat_gpt_api_key) = args.set_chat_gpt_api_key {
        config_service::write_config(repo, key, value)?
    }

    Ok(())
}
